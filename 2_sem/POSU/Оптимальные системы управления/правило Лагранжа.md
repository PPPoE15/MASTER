[для функции n-переменных]

Рассматривается общая задача условной оптимизации для конечномерного случая
![[Pasted image 20240422143053.png]]
Определим функцию 
![[Pasted image 20240422143133.png]]
где ![[Pasted image 20240422143142.png]], 
называемую функцией Лагранжа для задачи условной оптимизации (1), числа ![[Pasted image 20240422143249.png]] называются множителями Лагранжа.

Сформулируем теорему:
Правило множителей Лагранжа 
Пусть в задаче (1) все функции ![[Pasted image 20240422143443.png]] непрерывно дифференцируемые в окрестности точки ![[Pasted image 20240422143518.png]]. Если ![[Pasted image 20240422143525.png]] - точка локального экстремума в задаче (1) то следует:
1. Найдутся множители Лагранжа ![[Pasted image 20240422143350.png]] не равные нулю одновременно и такие что выполнено условие стационарности функции Лагранжа по х:![[Pasted image 20240422143735.png]]
2. Для того, чтобы ![[Pasted image 20240422143809.png]] достаточно (<=), чтобы вектора ![[Pasted image 20240422143909.png]] были линейно независимы. 
Прежде чем доказывать теорему обсудим её и покажем её использование на примере. Из правила Лагранжа следует, что для определения n+m+1 переменных ![[Pasted image 20240422144343.png]] имеется 
![[Pasted image 20240422144400.png]]
n+m уравнений
Множители Лагранжа определены с точностью до пропорциональности. Если известно, что ![[Pasted image 20240422143809.png]] , а ![[Pasted image 20240426102604.png]] это важнейший случай. Ибо если ![[Pasted image 20240426102648.png]] то это означает, что функция Лагранжа не связано f0 и ограничения вырожденные.

Тогда можно все множители разделить на ![[Pasted image 20240422143809.png]] , в результате получим ![[Pasted image 20240426102909.png]] и имеем n+m уравнений для определения n+m неизвестных ![[Pasted image 20240426102959.png]] 

Заметим что уравнения для определения ![[Pasted image 20240426102959.png]] можно записать в следующей симметричной форме
![[Pasted image 20240426174606.png]]
Решение этих уравнений называют стационарными точками задачи (1). Со времен Лагранжа, почти на протяжении 100 лет правило множителей формулировалось для ![[Pasted image 20240426102909.png]] хотя без дополгительного предположения ![[Pasted image 20240426174957.png]]
это не верно. Для подтверждения этого рассмотрим задачу на плоскости![[Pasted image 20240426175054.png]]
Ограничению f1(x) удовлетворяет единственная точка на плоскости х1=х2=0. По этому только эта точка и может быть экстримальной т.е. ![[Pasted image 20240426175224.png]] 
Заметим что ![[Pasted image 20240426175240.png]] т.е. это нулевой вектор (ЛЗ для m=1) поэтому для этого примера не выполнено второе условие теоремы и ![[Pasted image 20240426102648.png]].
Проверим это дважды решив эту задачу.

1. Положим ![[Pasted image 20240426175511.png]] и составим функцию Лагранжа ![[Pasted image 20240426175541.png]] тогда условия стационарности есть ![[Pasted image 20240426175620.png]] Из первого уравнения получаем ![[Pasted image 20240426175644.png]] подставляя это значение в третье уравнение получаем ![[Pasted image 20240426175731.png]] что не может быть для вещественных чисел.
2. Случай когда ![[Pasted image 20240426180548.png]] определяемый множитель . Составим функцию Лагранжа ![[Pasted image 20240426180624.png]] Условия стационарности для нее ![[Pasted image 20240426180701.png]] Обе части первого и второго уравнений возведем в квадрат и сложим ![[Pasted image 20240426180825.png]] второе слогаемое равно нулю т.к. ![[Pasted image 20240426180853.png]] , поэтому ![[Pasted image 20240426180908.png]] .
Решение ![[Pasted image 20240426180946.png]] , ![[Pasted image 20240426181014.png]] - произвольное удовлетворяет этому уравнению. Следовательно стационарная точка функции Лагранжа в этом примере ![[Pasted image 20240426181129.png]] - произвольное так как при этом удовлетворяются все уравнения.

И последнее, что нам потребуется для доказательства теоремы (правила Лагранжа) это известная теорема анализа - [[теорема об обратной функции]].

# Доказательство
Теорема утверждает , что в точке условного экстремума ![[Pasted image 20240422143518.png]] задачи (1) нулевая линейная комбинация векторов
![[Pasted image 20240502070047.png]]
имеет место, причем не все ![[Pasted image 20240502070307.png]] равны нулю.
т.е. вектора ![[Pasted image 20240502070336.png]] - линейно зависимые.
Доказательство от противного: предположим что вектора ![[Pasted image 20240502070336.png]] - линейно независимы и докажем что тогда точка ![[Pasted image 20240422143518.png]] - не есть точка локального минимума.
Вектора ![[Pasted image 20240502070336.png]] предполагаем следовательно ранг (m+1) x n матрицы составленной из векторов как из строк равен числу ЛНЗ строк, т.е. равен m+1.
![[Pasted image 20240502070902.png]]
Допустим, что первый m+1 столбец этой матрицы ЛНЗ (в противном случае можно перенумеровать переменные в задаче (1), чтобы это было выполнено). Следовательно квадратная матрица m+1 х m+1
![[Pasted image 20240502071314.png]]
имеет ранг m+1, следовательно не вырожденная, т.е. определитель ![[Pasted image 20240502071424.png]] 
Рассмотрим m+1 функцию m+1 переменных ![[Pasted image 20240502071459.png]] 
![[Pasted image 20240502071517.png]]
Заметим что 
1. ![[Pasted image 20240502085617.png]] i=1... m+1
2. производная этой функции ![[Pasted image 20240502085735.png]] для ![[Pasted image 20240502085748.png]] ![[Pasted image 20240502085808.png]] следовательно ![[Pasted image 20240502085832.png]] 
По теореме об обратной функции для ![[Pasted image 20240502090528.png]] для которой выполнено условие ![[Pasted image 20240502090604.png]]
Поэтому существует ![[Pasted image 20240502090633.png]] такое, что для любого ![[Pasted image 20240502090706.png]] найдутся решения ![[Pasted image 20240502090726.png]] системы уравнений 
![[Pasted image 20240502090803.png]]
причем ![[Pasted image 20240502090821.png]] отсюда следует, что  вектор ![[Pasted image 20240502090850.png]] 
1. удовлетворяет всем ограничениям в задаче (1) ![[Pasted image 20240502090953.png]]
2. Значение минимизируемой функции ![[Pasted image 20240502091020.png]] в точке ![[Pasted image 20240502091032.png]] ![[Pasted image 20240502091045.png]], а следовательно ![[Pasted image 20240502091108.png]] т.е. ![[Pasted image 20240422143518.png]] не является точкой локального экстремума.
Наше предположение о ЛНЗ векторов ![[Pasted image 20240502070336.png]] неверно, т.е. в точке локального экстремума вектора ![[Pasted image 20240502070336.png]] должны быть линейно зависимыми, т.е. найдутся множители не равные нулю одновременно для нулевой линейной комбинации этих векторов 
![[Pasted image 20240504073718.png]]
т.е. ![[Pasted image 20240504073733.png]]
# Доказательство второй части теоремы
Для того чтобы ![[Pasted image 20240422143809.png]] достаточно (<=) чтобы вектора ![[Pasted image 20240422143909.png]] были линейно независимы.
Доказательство 
По определению ЛНЗ векторов, вектора ![[Pasted image 20240422143909.png]] - ЛНЗ, если нулевая линейная комбинация этих векторов ![[Pasted image 20240504073718.png]] возможна только, если ![[Pasted image 20240504144712.png]].
По условию теоремы m+1 вектор ![[Pasted image 20240422143909.png]] - ЛЗ, т.е. ![[Pasted image 20240502070047.png]] при этом не все ![[Pasted image 20240504144959.png]] равны нулю, т.е. найдется хотя бы один ![[Pasted image 20240504145417.png]].
Пусть ![[Pasted image 20240426102648.png]] в этой линейной комбинации комбинации, тогда эта линейная комбинация принимает вид
![[Pasted image 20240504145912.png]]
и не все ![[Pasted image 20240504145941.png]] равны нулю т.е. из предположения ![[Pasted image 20240426102648.png]] следует, что вектора ![[Pasted image 20240422143909.png]] - ЛЗ.
что противоречит условию части 2 теоремы. Поэтому предположение, что ![[Pasted image 20240426102648.png]] не верное если вектора ![[Pasted image 20240422143909.png]] - ЛНЗ.
Теорема доказана.

Замечание - из теоремы следует, что для точки локального экстремума ![[Pasted image 20240422143518.png]] вектора ![[Pasted image 20240502070336.png]] - ЛЗ
и в случае когда ![[Pasted image 20240502070336.png]] - ЛНЗ то вектор ![[Pasted image 20240504151147.png]] есть линейная комбинация
![[Pasted image 20240504152856.png]]
т.е. вектора ![[Pasted image 20240504153339.png]] и вектор ![[Pasted image 20240504153705.png]] лежит на одной линии вектора градиента ![[Pasted image 20240504153339.png]]. Теперь изложим результат доказанной теоремы в виде правила Лагранжа. 
Чтобы найти экстремум в задаче условной оптимизации
![[Pasted image 20240504182732.png]]
следует использовать следующее правило Лагранжа
1. Составить функцию Лагранжа ![[Pasted image 20240504182831.png]] и рассмотреть экстремальную задачу для этой функции без ограничений, считая, что ![[Pasted image 20240504182934.png]] фиксированы ![[Pasted image 20240504182959.png]] Необходимое условие в этой задаче в соответствии с [[Конечномерные экстремальные задачи. Теорема Ферма]] для функции n - переменных дает уравнение стационарности по х для этой функции ![[Pasted image 20240504183438.png]] . Решение этого уравнения ![[Pasted image 20240504183508.png]] зависит от m+1 множителя ![[Pasted image 20240504183543.png]] которые должны удовлетворять m-уравнениям для ограничений ![[Pasted image 20240504183716.png]] 
Если вектора  ![[Pasted image 20240502070336.png]] - ЛНЗ то можно положить ![[Pasted image 20240504183839.png]] и для m неизвестных ![[Pasted image 20240504183906.png]] имеются m уравнений. Эти уравнения часто записывают как условия стационарности по ![[Pasted image 20240504184047.png]] функции Лагранжа
![[Pasted image 20240504184115.png]] 
# Пример. Условная оптимизация квадратичной формв при линейных ограничениях
Задана квадратичная форма
![[Pasted image 20240505072812.png]]
с положительно определенной nxn матрицей. Заданы m ограничений, матричным уравнениям
![[Pasted image 20240505073001.png]] 
где А-mxn матрица, ![[Pasted image 20240505073042.png]] строки матрицы А ЛНЗ, т.е. ранг А = m. Требуется решить задачу условной оптимизации
![[Pasted image 20240505073149.png]]
В соответствии с правилом Лагранжа
1. Построим функцию Лагранжа ![[Pasted image 20240505073254.png]] где ![[Pasted image 20240505073308.png]] строка множителей Лагранжа
2. Вычислим стационарную точку ![[Pasted image 20240422143518.png]] функции Лагранжа считая ![[Pasted image 20240504182934.png]]фиксированными ![[Pasted image 20240505073442.png]] Отсюда находим ![[Pasted image 20240505073505.png]] мы учли, что ![[Pasted image 20240505073526.png]] существует, т.к. ![[Pasted image 20240505073548.png]]  
3. Проверим, что можно положить ![[Pasted image 20240504183839.png]], для этого вычислим ![[Pasted image 20240505073753.png]] Если столбцы матрицы ![[Pasted image 20240505073853.png]] или строки матрицы А - ЛНЗ, а это значит, если ранг А = m, то можно положить ![[Pasted image 20240504183839.png]]. Мы уже сделали это условием задачи, поэтому ![[Pasted image 20240504183839.png]].
4. Определение ![[Pasted image 20240505074051.png]] из условия, что ![[Pasted image 20240422143518.png]] должно удовлетворять ограничениям ![[Pasted image 20240505074132.png]], т.е. ![[Pasted image 20240505074157.png]] отсюда получаем систему из m линейных уравнений ![[Pasted image 20240505074236.png]], Матрица  ![[Pasted image 20240505073526.png]] существует (т.к. ![[Pasted image 20240505073548.png]]), ранг матрицы А равен m, поэтому ![[Pasted image 20240505074352.png]] матрица имеет ранг m, поэтому она невырожденная, а следовательно матрица ![[Pasted image 20240505074513.png]] так же не вырожденная, поэтому существует решение этой линейной системы ![[Pasted image 20240505074621.png]] 
Окончательно, стационарная точка функции Лагранжа определяется выражением ![[Pasted image 20240505074719.png]]. 
Вычислим значение функции f0 в точке экстремума 
![[Pasted image 20240505074813.png]] 
Рассмотрим частный случай ![[Pasted image 20240505075024.png]] т.е. ![[Pasted image 20240505075043.png]] Изобразим на плоскости изолинии функции ![[Pasted image 20240505075112.png]] и линию определяемую ограничением ![[Pasted image 20240505075201.png]] 
![[Pasted image 20240505075223.png]]
Точка условного экстремума для этой задачи, как следует из рисунка равна ![[Pasted image 20240505075341.png]] Покажем это формально
![[Pasted image 20240505075416.png]] 
![[Pasted image 20240505075433.png]] 
Множитель Лагранжа ![[Pasted image 20240505075458.png]] 
Проверим, что для ![[Pasted image 20240505075537.png]] выполнено условие стационарности по х функции Лагранжа 
![[Pasted image 20240505075616.png]]

  
 
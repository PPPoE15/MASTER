В ряде важнейших задач оптимального управления конечное время t1 не задано и изменяется при поиске оптимального управления.
В задаче оптимального быстродействия - конечное время t1 оптимизируемый (минимизируемый) критерий.
Дополним задачу Лагранжа еще одной переменной - конечным временем t1. Таким образом считаем, что начальное время t0 фиксировано, а t1 подлежит определению в ходе решения задачи. Задача Лагранжа в Понтрягинской форме в этом случае имеет вид
![[Pasted image 20240506110331.png]]
В этой задаче управляемый процесс есть ![[Pasted image 20240506110408.png]]. Оптимальный управляемый процесс ![[Pasted image 20240506110447.png]].
Функция Лагранжа для этой задачи
![[Pasted image 20240506144133.png]]
где ![[Pasted image 20240506144144.png]], ![[Pasted image 20240506144212.png]] - n-мерная строка, ![[Pasted image 20240505114542.png]] - множители Лагранжа;
![[Pasted image 20240506144320.png]] - интегральный член;
![[Pasted image 20240506144346.png]] - терминальный член.
Введем обозначение по аналогии с введенными ранее
![[Pasted image 20240506144436.png]]
Используя правило Лагранжа получим необходимые условия для оптимального процесса (или условия стационарности для функции Лагранжа)
![[Pasted image 20240506110447.png]]
1. Условия стационарности функции Лагранжа по х есть
 а) Уравнение Эйлера ![[Pasted image 20240506144913.png]]
 б) Условия трансверсальности ![[Pasted image 20240506144950.png]]
 2. Условия стационарности по ![[Pasted image 20240506145127.png]]  ![[Pasted image 20240506145145.png]]
 3. Дополнительно возникает условие стационарности функции Лагранжа по t1 ![[Pasted image 20240506145258.png]]
 Теорема Эйлера-Лагранжа утверждает, что для необходимых условий (1)-(3)оптимального процесса найдутся множители Лагранжа ![[Pasted image 20240506145429.png]] (для задачи на минимум), ![[Pasted image 20240506145519.png]] не равные нулю одновременно.
 Покажем, что это утверждение находится в полном соответствии с общим правилом Лагранжа.
 Действительно, функция Лагранжа является функцией трех аргументов ![[Pasted image 20240506145704.png]]. Согласно правилу Лагранжа надлежит рассмотреть 3 задачи:
 ![[Pasted image 20240506145750.png]]
 Задача 1 является задачей Больца, поэтому условия 1а и 1б выписаны в полном соответствии с полученными ранее для задачи Больца.
 Задача 2 является так же задачей Больца, но вырожденной, так как ![[Pasted image 20240506150048.png]] не входит в интегральный член функции Лагранжа, а u(t0), u(t1) в её терминальный член, поэтому уравнение Эйлера превращается в (2), а условия трансверсальности отсутствуют.
 Задача 3 есть задача поиска экстремума функции одной переменной, поэтому (3) следует из теоремы Ферма.
 Запишем условия стационарности (1)-(3) в развернутом виде в соответствии с выражением для функции Лагранжа
 ![[Pasted image 20240506150506.png]] Из (1а) с учетом того что ![[Pasted image 20240506150532.png]], следует, что множитель Лагранжа p(t) есть каноническая переменная для уравнения Эйлера в канонической форме Гамильтона;
 ![[Pasted image 20240506150658.png]]
 получим уравнения Эйлера в исходных терминах классической задачи оптимального управления 
 ![[Pasted image 20240506150748.png]]
 это уравнение в задаче оптимального управления называют сопряженным уравнением
 Из (1б) получаем условия трансверсальности в развернутом виде
 ![[Pasted image 20240506150906.png]]
Из (2) получим ![[Pasted image 20240506150941.png]]
к этим уравнениям необходимо добавить ограничения из исходной задачи:
уравнение дифференциальной связи (уравнения объекта управления)
![[Pasted image 20240506151141.png]]
и граничные условия для него 
![[Pasted image 20240506151206.png]]
и наконец, для третьего аргумента функции Лагранжа t1, развернутое уравнение получается путем дифференцирования  по t1 функции Лагранжа
![[Pasted image 20240506151343.png]]
в которой аргумент  t1 присутствует в трех местах. Продифференцируем по каждому из этих трех аргументов t1
Напомним, что производная от интеграла с переменным верхним пределом вычисляется следующим образом
![[Pasted image 20240506151620.png]]
Производная от ![[Pasted image 20240506151637.png]] по первому аргументу t1 вычисляется как производная от аналогичной функции
![[Pasted image 20240506151719.png]]
выражение для ![[Pasted image 20240506151735.png]] возьмем из условия трансверсальности ![[Pasted image 20240506151822.png]]
в результате получим 
![[Pasted image 20240506151841.png]]
Производная ![[Pasted image 20240506154645.png]] по второму аргументу t1 равна
![[Pasted image 20240506154817.png]]
Складывая полученные три выражения, получим условия стационарности по t1
![[Pasted image 20240510205826.png]]
После сокращения членов ![[Pasted image 20240510205925.png]] окончательно получаем
![[Pasted image 20240510205943.png]]
условие стационарности (3) в развернутом виде.
# 7.4 Условие стационарности для классической задачи оптимального управления в канонической форме Гамильтона
Как уже было получено, каноническая переменная  
![[Pasted image 20240506150532.png]]
т.е. совпадает с множителем Лагранжа задачи.
Введем функцию Гамильтона 
![[Pasted image 20240510210319.png]]
которая для рассматриваемой задачи имеет вид
![[Pasted image 20240510210355.png]]
Дополним условия стационарности (1) и (2) уравнением дифференциальной связи 
![[Pasted image 20240510210511.png]]
В результате условия стационарности функции Лагранжа задачи оптимального управления (1) и (2) в канонической форме Гамильтона имеют вид
![[Pasted image 20240510210642.png]]
Проверим это путем вычисления указанных частных производных 
![[Pasted image 20240510210737.png]]
сравнивая их с условиями стационарности по х и по u и уравнение дифференциальной связи, убеждаемся, что  это эквивалентные уравнения.
Первые два из них являются векторными дифференциальными уравнениями порядка n ![[Pasted image 20240510211052.png]] и одна система из двух алгебраических уравнений относительно u=(u1, ... , u2).
Систему алгебраических уравнений ![[Pasted image 20240510211229.png]], теоретически можно разрешить, т.е. представить ![[Pasted image 20240510211304.png]]. Если строки этой системы ЛНЗ, т.е. Якобиан ![[Pasted image 20240510211348.png]].
Подставив последнее выражение в дифференциальное уравнение объекта управления и сопряженное уравнение, получим систему 2n однородных дифференциальных уравнений
![[Pasted image 20240510211555.png]]
которую называют Гамильтоновой системой задачи классического оптимального управления (оптимального управления без ограничений на управление).
Для решения этой системы требуется 2n краевых (граничных условий,  первые n граничных условий ![[Pasted image 20240510212013.png]] заданы в условиях задачи, их можно записать в симметричной форме ![[Pasted image 20240510212052.png]] )
так как ![[Pasted image 20240510212122.png]] Еще n граничных условий задает условие трансверсальности ![[Pasted image 20240510212159.png]]
Необходимо еще определить n множителей ![[Pasted image 20240510212235.png]] , что можно сделать из n оставшихся условий трансверсальности 
![[Pasted image 20240510212325.png]]

Для определения последнего неизвестного ![[Pasted image 20240510212351.png]] , так же имеется еще одно уравнение - условие стационарности функции Лагранжа по t1 ![[Pasted image 20240510212439.png]], которое выражается через функцию Гамильтона задачи 
![[Pasted image 20240510212600.png]]
Таким образом краевая задача 
![[Pasted image 20240510212624.png]]
является полной - число уравнений равно числу неизвестных и следовательно она может быть (теоретически) решена.

Замечание.
В этой задаче имеется еще одна переменная ![[Pasted image 20240510212804.png]] для которой нет уравнения. 
Для конечномерной задачи поиска условного экстремума было показано что ![[Pasted image 20240510212922.png]] при некоторых условиях можно положить ![[Pasted image 20240510212956.png]]. Здесь ситуация аналогичная.

Необходимо прямой проверкой убедиться, что ![[Pasted image 20240510212804.png]]=0 противоречит условию теоремы [[метод оптимизации Эйлера-Лагранжа]] после чего, можно положить ![[Pasted image 20240510212804.png]]=1. Как делается такая проверка будет показано при решении конкретных задач оптимизационного управления.